<!--
// RMIT University Vietnam
// Course: COSC2430 Web Programming
// Semester: 2023B
// Assessment: Assignment 2
// Author: Huynh Duc Gia Tin, Tran Ha Phuong, Nguyen Viet Ha, Phan Nhat Minh, Tran Nguyen Quoc An
// ID: s3962053, s3979638, s3978128, s3959931, s3978598 
// Acknowledgement: MDN Web Docs, Youtube, W3school, GeeksforGeeks, RMIT Canvas, ChatGPT, NPM Packages' Docs
-->

<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Customer Register</title>
    <meta charset="UTF-8" />
    <link rel="preconnect" href="https://fonts.gstatic.com" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link href="/css/main.css" rel="stylesheet" />
    <link href="/css/bootstrap.css" rel="stylesheet" />
    <script src="/js/validation.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap"
      rel="stylesheet"
    />
    <!--Stylesheet-->
    <link rel="stylesheet" href="/css/register.css" />
  </head>
  <body>
    <div class="background"></div>

    <form method="POST" action="/api/customers/register">
      <h3>Register Here</h3>
      <div class="container">
        <div class="row">
          <div class="col-6">
            <label for="firstname">Firstname and Lastname</label>
            <input
              type="text"
              placeholder="Enter your first and lastname"
              id="firstname"
              name="name"
              required
            />

            <label for="username">Username</label>
            <input
              type="text"
              placeholder="Enter your username"
              id="username"
              required
              name="username"
            />

            <label for="gender">Gender</label>
            <div class="radio">
              <div class="radio-input d-flex align-items-center pe-3">
                <label class="m-0 pe-2" for="">Female</label>
                <input
                  class="m-0"
                  type="radio"
                  name="gender"
                  id=""
                  value="FEMALE"
                  checked
                />
              </div>

              <div class="radio-input d-flex align-items-center pe-3">
                <label class="m-0 pe-2" for="">Male</label>
                <input
                  class="m-0"
                  type="radio"
                  name="gender"
                  id=""
                  value="MALE"
                />
              </div>
              <div class="radio-input d-flex align-items-center">
                <label class="m-0 pe-2" for="">Others</label>
                <input
                  class="m-0"
                  type="radio"
                  name="gender"
                  id=""
                  value="OTHERS"
                />
              </div>
            </div>
          </div>

          <div class="col-6">
            <label for="address">Address</label>
            <input
              type="text"
              placeholder="Address"
              id="address"
              name="address"
              required
            />

            <label for="password">Password</label>
            <input
              type="password"
              placeholder="Password"
              id="password"
              name="password"
              required
            />

            <label for="repassword">Re-Password</label>
            <input
              type="password"
              placeholder="Repassword"
              id="repassword"
              required
              name="repassword"
            />
          </div>
        </div>
      </div>

      <div class="col-12">
        <button type="submit">Sign up</button>

        <div class="social">
          <div class="alt-link go"><i class="fab fa-google"></i> Google</div>
          <div class="alt-link fb">
            <i class="fab fa-facebook"></i> Facebook
          </div>
        </div>
        <p class="m-auto mt-2 text-center fst-italic">
          <a class="text-decoration-none" href="login">
            Arealdy have an account? Sign in</a
          >
        </p>
      </div>
    </form>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
      $("form").submit(function (event) {
        event.preventDefault(); // Prevent the default form submission behavior
        clearErrorStyles();

        // Validate the form data
        const errors = [];
        const address = $("[name=address]").val();
        const username = $("[name=username]").val();
        const name = $("[name=name]").val();
        const password = $("[name=password]").val();
        const repassword = $("[name=repassword]").val();

        if (!validatePassword(password)) {
          errors.push("Password must be at least 8 characters long");
          displayErrorMessage(
            "Password needs to have least one lower case letter, at least one digit, at least one special character, 8 to 20 characters",
            "password"
          );
        }
        if (password !== repassword) {
          errors.push("Passwords do not match");
          displayErrorMessage("Password does not match", "repassword");
        }
        if (!validateMinLength(address, 5)) {
          errors.push("Address must be at least 5 characters long");
          displayErrorMessage(
            "Address must be at least 5 characters long",
            "address"
          );
        }
        if (!validateMinLength(username, 5)) {
          errors.push("Username must be at least 5 characters long");
          displayErrorMessage(
            "Username must be at least 5 characters long",
            "username"
          );
        }
        if (!validateMinLength(name, 5)) {
          errors.push("Name must be at least 5 characters long");
          displayErrorMessage(
            "Address must be at least 5 characters long",
            "name"
          );
        }

        // If there are errors, prevent form submission
        if (errors.length > 0) {
          return;
        }

        // Add the teamMembers array to the form data
        const formData = {
          name: $("[name=name]").val(),
          username: $("[name=username]").val(),
          password: $("[name=password]").val(),
          address: $("[name=address]").val(),
          gender: $("[name=gender]").val(),
          profilePicture: "",
        };

        console.log(JSON.stringify(formData));
        // Send the formData to the server

        $.ajax({
          url: "register", // Replace with the correct URL for your server endpoint
          type: "POST",
          contentType: "application/json",
          data: JSON.stringify(formData),
        });
      });
    </script>
  </body>
</html>
